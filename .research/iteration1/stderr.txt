Using CPython 3.11.14
Creating virtual environment at: .venv
Resolved 126 packages in 178ms
Installed 96 packages in 6.70s
 + aiohappyeyeballs==2.6.1
 + aiohttp==3.13.2
 + aiosignal==1.4.0
 + alembic==1.17.1
 + annotated-types==0.7.0
 + antlr4-python3-runtime==4.9.3
 + anyio==4.11.0
 + attrs==25.4.0
 + certifi==2025.10.5
 + charset-normalizer==3.4.4
 + click==8.3.0
 + colorlog==6.10.1
 + contourpy==1.3.3
 + cycler==0.12.1
 + datasets==4.4.1
 + dill==0.4.0
 + filelock==3.20.0
 + fonttools==4.60.1
 + frozenlist==1.8.0
 + fsspec==2025.10.0
 + gitdb==4.0.12
 + gitpython==3.1.45
 + greenlet==3.2.4
 + h11==0.16.0
 + hf-xet==1.2.0
 + httpcore==1.0.9
 + httpx==0.28.1
 + huggingface-hub==0.36.0
 + hydra-core==1.3.2
 + idna==3.11
 + jinja2==3.1.6
 + joblib==1.5.2
 + kiwisolver==1.4.9
 + mako==1.3.10
 + markupsafe==3.0.3
 + matplotlib==3.10.7
 + mpmath==1.3.0
 + multidict==6.7.0
 + multiprocess==0.70.18
 + networkx==3.5
 + numpy==2.3.4
 + nvidia-cublas-cu12==12.8.4.1
 + nvidia-cuda-cupti-cu12==12.8.90
 + nvidia-cuda-nvrtc-cu12==12.8.93
 + nvidia-cuda-runtime-cu12==12.8.90
 + nvidia-cudnn-cu12==9.10.2.21
 + nvidia-cufft-cu12==11.3.3.83
 + nvidia-cufile-cu12==1.13.1.3
 + nvidia-curand-cu12==10.3.9.90
 + nvidia-cusolver-cu12==11.7.3.90
 + nvidia-cusparse-cu12==12.5.8.93
 + nvidia-cusparselt-cu12==0.7.1
 + nvidia-nccl-cu12==2.27.5
 + nvidia-nvjitlink-cu12==12.8.93
 + nvidia-nvshmem-cu12==3.3.20
 + nvidia-nvtx-cu12==12.8.90
 + omegaconf==2.3.0
 + optuna==4.5.0
 + packaging==25.0
 + pandas==2.3.3
 + pillow==12.0.0
 + platformdirs==4.5.0
 + propcache==0.4.1
 + protobuf==6.33.0
 + pyarrow==22.0.0
 + pydantic==2.12.4
 + pydantic-core==2.41.5
 + pyparsing==3.2.5
 + python-dateutil==2.9.0.post0
 + pytz==2025.2
 + pyyaml==6.0.3
 + regex==2025.11.3
 + requests==2.32.5
 + safetensors==0.6.2
 + scikit-learn==1.7.2
 + scipy==1.16.3
 + seaborn==0.13.2
 + sentry-sdk==2.43.0
 + six==1.17.0
 + smmap==5.0.2
 + sniffio==1.3.1
 + sqlalchemy==2.0.44
 + sympy==1.14.0
 + threadpoolctl==3.6.0
 + tokenizers==0.22.1
 + torch==2.9.0
 + tqdm==4.67.1
 + transformers==4.57.1
 + triton==3.5.0
 + typing-extensions==4.15.0
 + typing-inspection==0.4.2
 + tzdata==2025.2
 + urllib3==2.5.0
 + wandb==0.22.3
 + xxhash==3.6.0
 + yarl==1.22.0
Fetching 2 files:   0%|          | 0/2 [00:00<?, ?it/s]Fetching 2 files:  50%|█████     | 1/2 [00:24<00:24, 24.42s/it]Fetching 2 files: 100%|██████████| 2/2 [00:24<00:00, 12.21s/it]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  1.25it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  2.07it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.88it/s]
opus_books_en_fr e0:   0%|          | 0/50000 [00:00<?, ?it/s]`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.
/mnt/home/toma/KRK-039/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/.venv/lib/python3.11/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
opus_books_en_fr e0:   0%|          | 1/50000 [00:02<33:47:34,  2.43s/it]opus_books_en_fr e0:   0%|          | 2/50000 [00:02<17:20:02,  1.25s/it]
wmt14_en_de e0:   0%|          | 0/50000 [00:00<?, ?it/s]wmt14_en_de e0:   0%|          | 1/50000 [00:01<20:19:44,  1.46s/it]wmt14_en_de e0:   0%|          | 2/50000 [00:01<10:39:32,  1.30it/s]
Using CPython 3.11.14
Creating virtual environment at: .venv
Resolved 126 packages in 171ms
Installed 96 packages in 7.08s
 + aiohappyeyeballs==2.6.1
 + aiohttp==3.13.2
 + aiosignal==1.4.0
 + alembic==1.17.1
 + annotated-types==0.7.0
 + antlr4-python3-runtime==4.9.3
 + anyio==4.11.0
 + attrs==25.4.0
 + certifi==2025.10.5
 + charset-normalizer==3.4.4
 + click==8.3.0
 + colorlog==6.10.1
 + contourpy==1.3.3
 + cycler==0.12.1
 + datasets==4.4.1
 + dill==0.4.0
 + filelock==3.20.0
 + fonttools==4.60.1
 + frozenlist==1.8.0
 + fsspec==2025.10.0
 + gitdb==4.0.12
 + gitpython==3.1.45
 + greenlet==3.2.4
 + h11==0.16.0
 + hf-xet==1.2.0
 + httpcore==1.0.9
 + httpx==0.28.1
 + huggingface-hub==0.36.0
 + hydra-core==1.3.2
 + idna==3.11
 + jinja2==3.1.6
 + joblib==1.5.2
 + kiwisolver==1.4.9
 + mako==1.3.10
 + markupsafe==3.0.3
 + matplotlib==3.10.7
 + mpmath==1.3.0
 + multidict==6.7.0
 + multiprocess==0.70.18
 + networkx==3.5
 + numpy==2.3.4
 + nvidia-cublas-cu12==12.8.4.1
 + nvidia-cuda-cupti-cu12==12.8.90
 + nvidia-cuda-nvrtc-cu12==12.8.93
 + nvidia-cuda-runtime-cu12==12.8.90
 + nvidia-cudnn-cu12==9.10.2.21
 + nvidia-cufft-cu12==11.3.3.83
 + nvidia-cufile-cu12==1.13.1.3
 + nvidia-curand-cu12==10.3.9.90
 + nvidia-cusolver-cu12==11.7.3.90
 + nvidia-cusparse-cu12==12.5.8.93
 + nvidia-cusparselt-cu12==0.7.1
 + nvidia-nccl-cu12==2.27.5
 + nvidia-nvjitlink-cu12==12.8.93
 + nvidia-nvshmem-cu12==3.3.20
 + nvidia-nvtx-cu12==12.8.90
 + omegaconf==2.3.0
 + optuna==4.5.0
 + packaging==25.0
 + pandas==2.3.3
 + pillow==12.0.0
 + platformdirs==4.5.0
 + propcache==0.4.1
 + protobuf==6.33.0
 + pyarrow==22.0.0
 + pydantic==2.12.4
 + pydantic-core==2.41.5
 + pyparsing==3.2.5
 + python-dateutil==2.9.0.post0
 + pytz==2025.2
 + pyyaml==6.0.3
 + regex==2025.11.3
 + requests==2.32.5
 + safetensors==0.6.2
 + scikit-learn==1.7.2
 + scipy==1.16.3
 + seaborn==0.13.2
 + sentry-sdk==2.43.0
 + six==1.17.0
 + smmap==5.0.2
 + sniffio==1.3.1
 + sqlalchemy==2.0.44
 + sympy==1.14.0
 + threadpoolctl==3.6.0
 + tokenizers==0.22.1
 + torch==2.9.0
 + tqdm==4.67.1
 + transformers==4.57.1
 + triton==3.5.0
 + typing-extensions==4.15.0
 + typing-inspection==0.4.2
 + tzdata==2025.2
 + urllib3==2.5.0
 + wandb==0.22.3
 + xxhash==3.6.0
 + yarl==1.22.0
Fetching 2 files:   0%|          | 0/2 [00:00<?, ?it/s]Fetching 2 files:  50%|█████     | 1/2 [00:21<00:21, 21.28s/it]Fetching 2 files: 100%|██████████| 2/2 [00:21<00:00, 10.64s/it]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  1.30it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  2.15it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.96it/s]
opus_books_en_fr e0:   0%|          | 0/50000 [00:00<?, ?it/s]`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.
/mnt/home/toma/KRK-039/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/.venv/lib/python3.11/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
opus_books_en_fr e0:   0%|          | 1/50000 [00:02<37:35:36,  2.71s/it]opus_books_en_fr e0:   0%|          | 2/50000 [00:02<19:15:03,  1.39s/it]
wmt14_en_de e0:   0%|          | 0/50000 [00:00<?, ?it/s]wmt14_en_de e0:   0%|          | 1/50000 [00:01<21:03:02,  1.52s/it]wmt14_en_de e0:   0%|          | 2/50000 [00:01<11:01:15,  1.26it/s]
Using CPython 3.11.13
Creating virtual environment at: .venv
Resolved 126 packages in 198ms
Installed 96 packages in 5.48s
 + aiohappyeyeballs==2.6.1
 + aiohttp==3.13.2
 + aiosignal==1.4.0
 + alembic==1.17.1
 + annotated-types==0.7.0
 + antlr4-python3-runtime==4.9.3
 + anyio==4.11.0
 + attrs==25.4.0
 + certifi==2025.10.5
 + charset-normalizer==3.4.4
 + click==8.3.0
 + colorlog==6.10.1
 + contourpy==1.3.3
 + cycler==0.12.1
 + datasets==4.4.1
 + dill==0.4.0
 + filelock==3.20.0
 + fonttools==4.60.1
 + frozenlist==1.8.0
 + fsspec==2025.10.0
 + gitdb==4.0.12
 + gitpython==3.1.45
 + greenlet==3.2.4
 + h11==0.16.0
 + hf-xet==1.2.0
 + httpcore==1.0.9
 + httpx==0.28.1
 + huggingface-hub==0.36.0
 + hydra-core==1.3.2
 + idna==3.11
 + jinja2==3.1.6
 + joblib==1.5.2
 + kiwisolver==1.4.9
 + mako==1.3.10
 + markupsafe==3.0.3
 + matplotlib==3.10.7
 + mpmath==1.3.0
 + multidict==6.7.0
 + multiprocess==0.70.18
 + networkx==3.5
 + numpy==2.3.4
 + nvidia-cublas-cu12==12.8.4.1
 + nvidia-cuda-cupti-cu12==12.8.90
 + nvidia-cuda-nvrtc-cu12==12.8.93
 + nvidia-cuda-runtime-cu12==12.8.90
 + nvidia-cudnn-cu12==9.10.2.21
 + nvidia-cufft-cu12==11.3.3.83
 + nvidia-cufile-cu12==1.13.1.3
 + nvidia-curand-cu12==10.3.9.90
 + nvidia-cusolver-cu12==11.7.3.90
 + nvidia-cusparse-cu12==12.5.8.93
 + nvidia-cusparselt-cu12==0.7.1
 + nvidia-nccl-cu12==2.27.5
 + nvidia-nvjitlink-cu12==12.8.93
 + nvidia-nvshmem-cu12==3.3.20
 + nvidia-nvtx-cu12==12.8.90
 + omegaconf==2.3.0
 + optuna==4.5.0
 + packaging==25.0
 + pandas==2.3.3
 + pillow==12.0.0
 + platformdirs==4.5.0
 + propcache==0.4.1
 + protobuf==6.33.0
 + pyarrow==22.0.0
 + pydantic==2.12.4
 + pydantic-core==2.41.5
 + pyparsing==3.2.5
 + python-dateutil==2.9.0.post0
 + pytz==2025.2
 + pyyaml==6.0.3
 + regex==2025.11.3
 + requests==2.32.5
 + safetensors==0.6.2
 + scikit-learn==1.7.2
 + scipy==1.16.3
 + seaborn==0.13.2
 + sentry-sdk==2.43.0
 + six==1.17.0
 + smmap==5.0.2
 + sniffio==1.3.1
 + sqlalchemy==2.0.44
 + sympy==1.14.0
 + threadpoolctl==3.6.0
 + tokenizers==0.22.1
 + torch==2.9.0
 + tqdm==4.67.1
 + transformers==4.57.1
 + triton==3.5.0
 + typing-extensions==4.15.0
 + typing-inspection==0.4.2
 + tzdata==2025.2
 + urllib3==2.5.0
 + wandb==0.22.3
 + xxhash==3.6.0
 + yarl==1.22.0
[I 2025-11-08 09:01:08,578] A new study created in memory with name: no-name-ff29f11b-a5b9-4e6a-89e6-85665ec10a7b
Fetching 2 files:   0%|          | 0/2 [00:00<?, ?it/s]Fetching 2 files:  50%|█████     | 1/2 [00:27<00:27, 27.97s/it]Fetching 2 files: 100%|██████████| 2/2 [00:27<00:00, 13.99s/it]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:01<00:01,  1.91s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.16s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.27s/it]
opus_books_en_fr e0:   0%|          | 0/50000 [00:00<?, ?it/s]opus_books_en_fr e0:   0%|          | 0/50000 [00:01<?, ?it/s]
[W 2025-11-08 09:02:31,607] Trial 0 failed with parameters: {'learning_rate': 1.5508932936361564e-05, 'similarity_threshold_tau': 0.8372471845864681, 'kd_tree_fanout': 8, 'router_temperature_init': 1.6193028299177818, 'weight_decay': 0.0067566346542969604} because of the following error: KeyError('article').
Traceback (most recent call last):
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/.venv/lib/python3.11/site-packages/optuna/study/_optimize.py", line 201, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/src/train.py", line 319, in _objective
    score = train_full_stream(cfg_t, trial)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/src/train.py", line 222, in train_full_stream
    for step, batch in pbar_it:
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/.venv/lib/python3.11/site-packages/tqdm/std.py", line 1181, in __iter__
    for obj in iterable:
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/.venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/.venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/.venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 33, in fetch
    data.append(next(self.dataset_iter))
                ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/.venv/lib/python3.11/site-packages/datasets/iterable_dataset.py", line 2538, in __iter__
    for key, example in ex_iterable:
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/.venv/lib/python3.11/site-packages/datasets/iterable_dataset.py", line 1252, in __iter__
    yield from self._iter()
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/.venv/lib/python3.11/site-packages/datasets/iterable_dataset.py", line 1431, in _iter
    for key, transformed_example in outputs:
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/.venv/lib/python3.11/site-packages/datasets/iterable_dataset.py", line 1416, in iter_outputs
    yield i, apply_function(key_example, i)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/.venv/lib/python3.11/site-packages/datasets/iterable_dataset.py", line 1346, in apply_function
    processed_inputs = self.function(*fn_args, *additional_args, **fn_kwargs)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/src/preprocess.py", line 158, in tok_fn
    prompt, tgt = builder(example)
                  ^^^^^^^^^^^^^^^^
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/src/preprocess.py", line 69, in build_summarisation
    return f"Summarise: {example[doc]}\nSUMMARY:", example[sum]
                         ~~~~~~~^^^^^
KeyError: 'article'
[W 2025-11-08 09:02:31,614] Trial 0 failed with value None.
Error executing job with overrides: ['run=proposed-iter1-Llama-2-7B-HF-4-bit-QLoRA-7-B-parameters', 'results_dir=.research/iteration1', 'mode=full']
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/src/train.py", line 359, in <module>
    main()
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/.venv/lib/python3.11/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/.venv/lib/python3.11/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/.venv/lib/python3.11/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/.venv/lib/python3.11/site-packages/hydra/_internal/utils.py", line 223, in run_and_report
    raise ex
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/.venv/lib/python3.11/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
           ^^^^^^
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/.venv/lib/python3.11/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
            ^^^^^^^^^^
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/.venv/lib/python3.11/site-packages/hydra/_internal/hydra.py", line 132, in run
    _ = ret.return_value
        ^^^^^^^^^^^^^^^^
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/.venv/lib/python3.11/site-packages/hydra/core/utils.py", line 260, in return_value
    raise self._return_value
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/.venv/lib/python3.11/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
                       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/src/train.py", line 349, in main
    best_params = launch_optuna(cfg)
                  ^^^^^^^^^^^^^^^^^^
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/src/train.py", line 324, in launch_optuna
    study.optimize(_objective, n_trials=cfg.optuna.n_trials)
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/.venv/lib/python3.11/site-packages/optuna/study/study.py", line 490, in optimize
    _optimize(
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/.venv/lib/python3.11/site-packages/optuna/study/_optimize.py", line 63, in _optimize
    _optimize_sequential(
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/.venv/lib/python3.11/site-packages/optuna/study/_optimize.py", line 160, in _optimize_sequential
    frozen_trial_id = _run_trial(study, func, catch)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/.venv/lib/python3.11/site-packages/optuna/study/_optimize.py", line 258, in _run_trial
    raise func_err
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/.venv/lib/python3.11/site-packages/optuna/study/_optimize.py", line 201, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/src/train.py", line 319, in _objective
    score = train_full_stream(cfg_t, trial)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/src/train.py", line 222, in train_full_stream
    for step, batch in pbar_it:
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/.venv/lib/python3.11/site-packages/tqdm/std.py", line 1181, in __iter__
    for obj in iterable:
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/.venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/.venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/.venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 33, in fetch
    data.append(next(self.dataset_iter))
                ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/.venv/lib/python3.11/site-packages/datasets/iterable_dataset.py", line 2538, in __iter__
    for key, example in ex_iterable:
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/.venv/lib/python3.11/site-packages/datasets/iterable_dataset.py", line 1252, in __iter__
    yield from self._iter()
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/.venv/lib/python3.11/site-packages/datasets/iterable_dataset.py", line 1431, in _iter
    for key, transformed_example in outputs:
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/.venv/lib/python3.11/site-packages/datasets/iterable_dataset.py", line 1416, in iter_outputs
    yield i, apply_function(key_example, i)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/.venv/lib/python3.11/site-packages/datasets/iterable_dataset.py", line 1346, in apply_function
    processed_inputs = self.function(*fn_args, *additional_args, **fn_kwargs)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/src/preprocess.py", line 158, in tok_fn
    prompt, tgt = builder(example)
                  ^^^^^^^^^^^^^^^^
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/src/preprocess.py", line 69, in build_summarisation
    return f"Summarise: {example[doc]}\nSUMMARY:", example[sum]
                         ~~~~~~~^^^^^
KeyError: 'article'
Error executing job with overrides: ['run=proposed-iter1-Llama-2-7B-HF-4-bit-QLoRA-7-B-parameters', 'results_dir=.research/iteration1', 'mode=full']
Traceback (most recent call last):
  File "/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/src/main.py", line 41, in main
    subprocess.run(cmd, check=True, env=env)
  File "/home/toma/.local/share/uv/python/cpython-3.11.13-linux-x86_64-gnu/lib/python3.11/subprocess.py", line 571, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/home/toma/t-80-8-b-03/_work/airas-20251108-073457-matsuzawa/airas-20251108-073457-matsuzawa/.venv/bin/python3', '-u', '-m', 'src.train', 'run=proposed-iter1-Llama-2-7B-HF-4-bit-QLoRA-7-B-parameters', 'results_dir=.research/iteration1', 'mode=full']' returned non-zero exit status 1.

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
